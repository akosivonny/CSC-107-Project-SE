import{d as be,g as je,r as v,h as Pe,_ as ae,l as n,j as e,s as T,m as O,n as Y,o as Ce,F as Be,G as Se,q as Z,H as we,I as z,J as De,K as Te,c as Le,P as Me,B as Q,T as se,b as X}from"./index-z0K9aNkG.js";import{C as Ae}from"./Container-BImiuYkV.js";import{A as re,S as $e}from"./Snackbar-BH0trEap.js";import{a as Ue,S as Ne,T as U}from"./TextField-B85Xz2xy.js";import{M}from"./MenuItem-FM9UZ6zV.js";import{T as h,a as ze,b as _e,c as Fe,d as oe,e as Ee}from"./TableRow-C2GgRgt6.js";import{C as ie}from"./Chip-CcJxQYY9.js";import{E as We}from"./Edit-C50tj2DT.js";import{B as He}from"./Block-OHLm-sqy.js";import{A as Ke}from"./CheckCircle-Dpa2SAus.js";import{D as Je}from"./Delete-gogUZDZ4.js";import{u as ce}from"./useId-CEkL0nOO.js";import{D as ue,a as de}from"./DialogContent-DPXOk6da.js";import{D as he}from"./DialogTitle-DdgnUGFV.js";import{D as pe}from"./DialogActions-MulIAK1Y.js";import"./useThemeProps-DBuWnIrX.js";import"./useSlot-XS7t6U-k.js";import"./dividerClasses-KJHE8iFI.js";function Ge(s){return be("MuiCircularProgress",s)}je("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Ve=["className","color","disableShrink","size","style","thickness","value","variant"];let ee=s=>s,me,ge,xe,fe;const N=44,Oe=Se(me||(me=ee`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),qe=Se(ge||(ge=ee`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),Ze=s=>{const{classes:o,variant:r,color:u,disableShrink:p}=s,P={root:["root",r,`color${Y(u)}`],svg:["svg"],circle:["circle",`circle${Y(r)}`,p&&"circleDisableShrink"]};return Ce(P,Ge,o)},Qe=T("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(s,o)=>{const{ownerState:r}=s;return[o.root,o[r.variant],o[`color${Y(r.color)}`]]}})(({ownerState:s,theme:o})=>n({display:"inline-block"},s.variant==="determinate"&&{transition:o.transitions.create("transform")},s.color!=="inherit"&&{color:(o.vars||o).palette[s.color].main}),({ownerState:s})=>s.variant==="indeterminate"&&Be(xe||(xe=ee`
      animation: ${0} 1.4s linear infinite;
    `),Oe)),Xe=T("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(s,o)=>o.svg})({display:"block"}),Ye=T("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(s,o)=>{const{ownerState:r}=s;return[o.circle,o[`circle${Y(r.variant)}`],r.disableShrink&&o.circleDisableShrink]}})(({ownerState:s,theme:o})=>n({stroke:"currentColor"},s.variant==="determinate"&&{transition:o.transitions.create("stroke-dashoffset")},s.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:s})=>s.variant==="indeterminate"&&!s.disableShrink&&Be(fe||(fe=ee`
      animation: ${0} 1.4s ease-in-out infinite;
    `),qe)),et=v.forwardRef(function(o,r){const u=Pe({props:o,name:"MuiCircularProgress"}),{className:p,color:P="primary",disableShrink:C=!1,size:k=40,style:w,thickness:B=3.6,value:d=0,variant:L="indeterminate"}=u,R=ae(u,Ve),S=n({},u,{color:P,disableShrink:C,size:k,thickness:B,value:d,variant:L}),m=Ze(S),y={},l={},a={};if(L==="determinate"){const g=2*Math.PI*((N-B)/2);y.strokeDasharray=g.toFixed(3),a["aria-valuenow"]=Math.round(d),y.strokeDashoffset=`${((100-d)/100*g).toFixed(3)}px`,l.transform="rotate(-90deg)"}return e.jsx(Qe,n({className:O(m.root,p),style:n({width:k,height:k},l,w),ownerState:S,ref:r,role:"progressbar"},a,R,{children:e.jsx(Xe,{className:m.svg,ownerState:S,viewBox:`${N/2} ${N/2} ${N} ${N}`,children:e.jsx(Ye,{className:m.circle,style:y,ownerState:S,cx:N,cy:N,r:(N-B)/2,fill:"none",strokeWidth:B})})}))}),tt=Z(e.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),st=Z(e.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),ot=Z(e.jsx("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft"),at=Z(e.jsx("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight"),nt=["backIconButtonProps","count","disabled","getItemAriaLabel","nextIconButtonProps","onPageChange","page","rowsPerPage","showFirstButton","showLastButton","slots","slotProps"],lt=v.forwardRef(function(o,r){var u,p,P,C,k,w,B,d;const{backIconButtonProps:L,count:R,disabled:S=!1,getItemAriaLabel:m,nextIconButtonProps:y,onPageChange:l,page:a,rowsPerPage:g,showFirstButton:x,showLastButton:A,slots:I={},slotProps:c={}}=o,_=ae(o,nt),i=we(),F=K=>{l(K,0)},V=K=>{l(K,a-1)},$=K=>{l(K,a+1)},f=K=>{l(K,Math.max(0,Math.ceil(R/g)-1))},b=(u=I.firstButton)!=null?u:z,E=(p=I.lastButton)!=null?p:z,W=(P=I.nextButton)!=null?P:z,J=(C=I.previousButton)!=null?C:z,H=(k=I.firstButtonIcon)!=null?k:tt,G=(w=I.lastButtonIcon)!=null?w:st,j=(B=I.nextButtonIcon)!=null?B:at,t=(d=I.previousButtonIcon)!=null?d:ot,D=i?E:b,te=i?W:J,Ie=i?J:W,ye=i?b:E,Re=i?c.lastButton:c.firstButton,ne=i?c.nextButton:c.previousButton,le=i?c.previousButton:c.nextButton,ke=i?c.firstButton:c.lastButton;return e.jsxs("div",n({ref:r},_,{children:[x&&e.jsx(D,n({onClick:F,disabled:S||a===0,"aria-label":m("first",a),title:m("first",a)},Re,{children:i?e.jsx(G,n({},c.lastButtonIcon)):e.jsx(H,n({},c.firstButtonIcon))})),e.jsx(te,n({onClick:V,disabled:S||a===0,color:"inherit","aria-label":m("previous",a),title:m("previous",a)},ne??L,{children:i?e.jsx(j,n({},c.nextButtonIcon)):e.jsx(t,n({},c.previousButtonIcon))})),e.jsx(Ie,n({onClick:$,disabled:S||(R!==-1?a>=Math.ceil(R/g)-1:!1),color:"inherit","aria-label":m("next",a),title:m("next",a)},le??y,{children:i?e.jsx(t,n({},c.previousButtonIcon)):e.jsx(j,n({},c.nextButtonIcon))})),A&&e.jsx(ye,n({onClick:f,disabled:S||a>=Math.ceil(R/g)-1,"aria-label":m("last",a),title:m("last",a)},ke,{children:i?e.jsx(H,n({},c.firstButtonIcon)):e.jsx(G,n({},c.lastButtonIcon))}))]}))});function rt(s){return be("MuiTablePagination",s)}const q=je("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]);var ve;const it=["ActionsComponent","backIconButtonProps","className","colSpan","component","count","disabled","getItemAriaLabel","labelDisplayedRows","labelRowsPerPage","nextIconButtonProps","onPageChange","onRowsPerPageChange","page","rowsPerPage","rowsPerPageOptions","SelectProps","showFirstButton","showLastButton","slotProps","slots"],ct=T(h,{name:"MuiTablePagination",slot:"Root",overridesResolver:(s,o)=>o.root})(({theme:s})=>({overflow:"auto",color:(s.vars||s).palette.text.primary,fontSize:s.typography.pxToRem(14),"&:last-child":{padding:0}})),ut=T(Te,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(s,o)=>n({[`& .${q.actions}`]:o.actions},o.toolbar)})(({theme:s})=>({minHeight:52,paddingRight:2,[`${s.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[s.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${q.actions}`]:{flexShrink:0,marginLeft:20}})),dt=T("div",{name:"MuiTablePagination",slot:"Spacer",overridesResolver:(s,o)=>o.spacer})({flex:"1 1 100%"}),ht=T("p",{name:"MuiTablePagination",slot:"SelectLabel",overridesResolver:(s,o)=>o.selectLabel})(({theme:s})=>n({},s.typography.body2,{flexShrink:0})),pt=T(Ne,{name:"MuiTablePagination",slot:"Select",overridesResolver:(s,o)=>n({[`& .${q.selectIcon}`]:o.selectIcon,[`& .${q.select}`]:o.select},o.input,o.selectRoot)})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${q.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),mt=T(M,{name:"MuiTablePagination",slot:"MenuItem",overridesResolver:(s,o)=>o.menuItem})({}),gt=T("p",{name:"MuiTablePagination",slot:"DisplayedRows",overridesResolver:(s,o)=>o.displayedRows})(({theme:s})=>n({},s.typography.body2,{flexShrink:0}));function xt({from:s,to:o,count:r}){return`${s}â€“${o} of ${r!==-1?r:`more than ${o}`}`}function ft(s){return`Go to ${s} page`}const vt=s=>{const{classes:o}=s;return Ce({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},rt,o)},bt=v.forwardRef(function(o,r){var u;const p=Pe({props:o,name:"MuiTablePagination"}),{ActionsComponent:P=lt,backIconButtonProps:C,className:k,colSpan:w,component:B=h,count:d,disabled:L=!1,getItemAriaLabel:R=ft,labelDisplayedRows:S=xt,labelRowsPerPage:m="Rows per page:",nextIconButtonProps:y,onPageChange:l,onRowsPerPageChange:a,page:g,rowsPerPage:x,rowsPerPageOptions:A=[10,25,50,100],SelectProps:I={},showFirstButton:c=!1,showLastButton:_=!1,slotProps:i={},slots:F={}}=p,V=ae(p,it),$=p,f=vt($),b=(u=i==null?void 0:i.select)!=null?u:I,E=b.native?"option":mt;let W;(B===h||B==="td")&&(W=w||1e3);const J=ce(b.id),H=ce(b.labelId),G=()=>d===-1?(g+1)*x:x===-1?d:Math.min(d,(g+1)*x);return e.jsx(ct,n({colSpan:W,ref:r,as:B,ownerState:$,className:O(f.root,k)},V,{children:e.jsxs(ut,{className:f.toolbar,children:[e.jsx(dt,{className:f.spacer}),A.length>1&&e.jsx(ht,{className:f.selectLabel,id:H,children:m}),A.length>1&&e.jsx(pt,n({variant:"standard"},!b.variant&&{input:ve||(ve=e.jsx(Ue,{}))},{value:x,onChange:a,id:J,labelId:H},b,{classes:n({},b.classes,{root:O(f.input,f.selectRoot,(b.classes||{}).root),select:O(f.select,(b.classes||{}).select),icon:O(f.selectIcon,(b.classes||{}).icon)}),disabled:L,children:A.map(j=>v.createElement(E,n({},!De(E)&&{ownerState:$},{className:f.menuItem,key:j.label?j.label:j,value:j.value?j.value:j}),j.label?j.label:j))})),e.jsx(gt,{className:f.displayedRows,children:S({from:d===0?0:g*x+1,to:G(),count:d===-1?-1:d,page:g})}),e.jsx(P,{className:f.actions,backIconButtonProps:C,count:d,nextIconButtonProps:y,onPageChange:l,page:g,rowsPerPage:x,showFirstButton:c,showLastButton:_,slotProps:i.actions,slots:F.actions,getItemAriaLabel:R,disabled:L})]})}))}),jt=Z(e.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh"),Pt=()=>{try{const s=localStorage.getItem("mockUserDB");if(s){const r=JSON.parse(s),u=new Map(r),p=Array.from(u.entries()).filter(([P,C])=>P==="admin@farmmanagement.com"||C.role!=="student");localStorage.setItem("mockUserDB",JSON.stringify(p))}localStorage.removeItem("preEnrollments");const o=localStorage.getItem("user");return o&&JSON.parse(o).role==="student"&&localStorage.removeItem("user"),{success:!0,message:"All student data has been cleared successfully."}}catch(s){return console.error("Error clearing student data:",s),{success:!1,message:"Failed to clear student data. Please try again."}}},Ft=()=>{const{users:s,updateUser:o,deleteUser:r,refreshUsers:u}=Le(),[p,P]=v.useState(0),[C,k]=v.useState(10),[w,B]=v.useState(""),[d,L]=v.useState("all"),[R,S]=v.useState(null),[m,y]=v.useState(!1),[l,a]=v.useState({}),[g,x]=v.useState(null),[A,I]=v.useState(!1),[c,_]=v.useState(!1),[i,F]=v.useState({open:!1,message:"",severity:"success"});v.useEffect(()=>{u();const t=setInterval(u,5e3);return()=>clearInterval(t)},[u]);const V=()=>{I(!0),u(),setTimeout(()=>I(!1),1e3)},$=s.filter(t=>{const D=t.name.toLowerCase().includes(w.toLowerCase())||t.email.toLowerCase().includes(w.toLowerCase()),te=d==="all"||t.role===d;return D&&te}),f=[...$].sort((t,D)=>new Date(D.joinDate).getTime()-new Date(t.joinDate).getTime()),b=(t,D)=>{P(D)},E=t=>{k(parseInt(t.target.value,10)),P(0)},W=t=>{S(t),a({name:t.name,email:t.email,role:t.role,status:t.status,phone:t.phone,address:t.address}),y(!0)},J=()=>{R&&l&&(o(R.id,l),x({type:"success",message:"User updated successfully"}),y(!1),setTimeout(()=>x(null),3e3))},H=t=>{window.confirm("Are you sure you want to delete this user?")&&(r(t),x({type:"success",message:"User deleted successfully"}),setTimeout(()=>x(null),3e3))},G=t=>{const D=t.status==="active"?"inactive":"active";o(t.id,{status:D}),x({type:"success",message:`User ${D==="active"?"activated":"deactivated"} successfully`}),setTimeout(()=>x(null),3e3)},j=()=>{const t=Pt();_(!1),F({open:!0,message:t.message,severity:t.success?"success":"error"}),t.success&&setTimeout(()=>{window.location.reload()},1500)};return e.jsxs(Ae,{maxWidth:"lg",sx:{mt:4,mb:4},children:[g&&e.jsx(re,{severity:g.type,sx:{mb:2},onClose:()=>x(null),children:g.message}),e.jsxs(Me,{sx:{p:2,mb:2},children:[e.jsxs(Q,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(se,{variant:"h5",component:"div",children:"User Management"}),e.jsx(z,{onClick:V,disabled:A,title:"Refresh user list",children:A?e.jsx(et,{size:24}):e.jsx(jt,{})})]}),e.jsxs(Q,{sx:{mb:2,display:"flex",gap:2},children:[e.jsx(U,{label:"Search Users",variant:"outlined",size:"small",value:w,onChange:t=>B(t.target.value),sx:{minWidth:200}}),e.jsxs(U,{select:!0,label:"Filter by Role",value:d,onChange:t=>L(t.target.value),size:"small",sx:{minWidth:150},children:[e.jsx(M,{value:"all",children:"All Roles"}),e.jsx(M,{value:"admin",children:"Admin"}),e.jsx(M,{value:"student",children:"Student"}),e.jsx(M,{value:"visitor",children:"Visitor"})]})]}),e.jsx(ze,{children:e.jsxs(_e,{children:[e.jsx(Fe,{children:e.jsxs(oe,{children:[e.jsx(h,{children:"Name"}),e.jsx(h,{children:"Email"}),e.jsx(h,{children:"Role"}),e.jsx(h,{children:"Status"}),e.jsx(h,{children:"Join Date"}),e.jsx(h,{children:"Last Login"}),e.jsx(h,{align:"right",children:"Actions"})]})}),e.jsxs(Ee,{children:[f.slice(p*C,p*C+C).map(t=>e.jsxs(oe,{sx:{backgroundColor:Date.now()-new Date(t.joinDate).getTime()<5*60*1e3?"rgba(76, 175, 80, 0.08)":"inherit"},children:[e.jsx(h,{children:t.name}),e.jsx(h,{children:t.email}),e.jsx(h,{children:e.jsx(ie,{label:t.role.charAt(0).toUpperCase()+t.role.slice(1),color:t.role==="admin"?"error":t.role==="student"?"primary":"default",size:"small"})}),e.jsx(h,{children:e.jsx(ie,{label:t.status,color:t.status==="active"?"success":"default",size:"small"})}),e.jsx(h,{children:new Date(t.joinDate).toLocaleDateString()}),e.jsx(h,{children:new Date(t.lastLogin).toLocaleString()}),e.jsxs(h,{align:"right",children:[e.jsx(z,{size:"small",onClick:()=>W(t),title:"Edit user",children:e.jsx(We,{})}),e.jsx(z,{size:"small",onClick:()=>G(t),title:t.status==="active"?"Deactivate user":"Activate user",children:t.status==="active"?e.jsx(He,{}):e.jsx(Ke,{})}),e.jsx(z,{size:"small",onClick:()=>H(t.id),title:"Delete user",children:e.jsx(Je,{})})]})]},t.id)),f.length===0&&e.jsx(oe,{children:e.jsx(h,{colSpan:7,align:"center",children:"No users found"})})]})]})}),e.jsx(bt,{rowsPerPageOptions:[5,10,25],component:"div",count:$.length,rowsPerPage:C,page:p,onPageChange:b,onRowsPerPageChange:E})]}),e.jsxs(ue,{open:m,onClose:()=>y(!1),children:[e.jsx(he,{children:"Edit User"}),e.jsx(de,{children:e.jsxs(Q,{sx:{pt:2,display:"flex",flexDirection:"column",gap:2},children:[e.jsx(U,{label:"Name",fullWidth:!0,value:l.name||"",onChange:t=>a({...l,name:t.target.value})}),e.jsx(U,{label:"Email",fullWidth:!0,value:l.email||"",onChange:t=>a({...l,email:t.target.value})}),e.jsx(U,{label:"Phone",fullWidth:!0,value:l.phone||"",onChange:t=>a({...l,phone:t.target.value})}),e.jsx(U,{label:"Address",fullWidth:!0,value:l.address||"",onChange:t=>a({...l,address:t.target.value})}),e.jsxs(U,{select:!0,label:"Role",fullWidth:!0,value:l.role||"",onChange:t=>a({...l,role:t.target.value}),children:[e.jsx(M,{value:"student",children:"Student"}),e.jsx(M,{value:"visitor",children:"Visitor"})]}),e.jsxs(U,{select:!0,label:"Status",fullWidth:!0,value:l.status||"",onChange:t=>a({...l,status:t.target.value}),children:[e.jsx(M,{value:"active",children:"Active"}),e.jsx(M,{value:"inactive",children:"Inactive"})]})]})}),e.jsxs(pe,{children:[e.jsx(X,{onClick:()=>y(!1),children:"Cancel"}),e.jsx(X,{onClick:J,variant:"contained",color:"primary",children:"Save Changes"})]})]}),e.jsxs(ue,{open:c,onClose:()=>_(!1),children:[e.jsx(he,{children:"Clear All Student Data"}),e.jsxs(de,{children:[e.jsx(se,{children:"Are you sure you want to clear all student data? This action will:"}),e.jsxs(Q,{component:"ul",sx:{mt:1},children:[e.jsx("li",{children:"Delete all student accounts"}),e.jsx("li",{children:"Remove all enrollment records"}),e.jsx("li",{children:"Clear all student sessions"})]}),e.jsx(se,{color:"error",sx:{mt:2},children:"This action cannot be undone!"})]}),e.jsxs(pe,{children:[e.jsx(X,{onClick:()=>_(!1),children:"Cancel"}),e.jsx(X,{onClick:j,color:"error",variant:"contained",children:"Clear All Data"})]})]}),e.jsx($e,{open:i.open,autoHideDuration:3e3,onClose:()=>F({...i,open:!1}),anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(re,{onClose:()=>F({...i,open:!1}),severity:i.severity,children:i.message})})]})};export{Ft as default};
