import{d as W,g as z,r as m,h as B,_ as T,l as v,j as e,s as k,m as M,o as N,v as R,z as U,a as _,B as h,T as d,ad as G,E as O,b}from"./index-z0K9aNkG.js";import{G as n}from"./Grid-CyhzX6jj.js";import{T as C,F as $,I as q,S as H}from"./TextField-B85Xz2xy.js";import{I as J}from"./InputAdornment-B_guzNOi.js";import{S as K}from"./Search-Df7CFfZ_.js";import{M as A}from"./MenuItem-FM9UZ6zV.js";import{C as Q,a as V}from"./CardContent-BkRTlVoz.js";import{C as E}from"./Chip-CcJxQYY9.js";import{D as X,a as Y}from"./DialogContent-DPXOk6da.js";import{D as Z}from"./DialogTitle-DdgnUGFV.js";import{D as ee}from"./DialogActions-MulIAK1Y.js";import{S as te,A as se}from"./Snackbar-BH0trEap.js";import"./useId-CEkL0nOO.js";import"./dividerClasses-KJHE8iFI.js";import"./useSlot-XS7t6U-k.js";function ne(r){return W("MuiCardActions",r)}z("MuiCardActions",["root","spacing"]);const re=["disableSpacing","className"],ae=r=>{const{classes:l,disableSpacing:c}=r;return N({root:["root",!c&&"spacing"]},ne,l)},le=k("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(r,l)=>{const{ownerState:c}=r;return[l.root,!c.disableSpacing&&l.spacing]}})(({ownerState:r})=>v({display:"flex",alignItems:"center",padding:8},!r.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),oe=m.forwardRef(function(l,c){const s=B({props:l,name:"MuiCardActions"}),{disableSpacing:u=!1,className:S}=s,p=T(s,re),g=v({},s,{disableSpacing:u}),o=ae(g);return e.jsx(le,v({className:M(o.root,S),ownerState:g,ref:c},p))}),ye=()=>{const{courses:r}=R(),{submitPreEnrollment:l,getStudentEnrollmentStatus:c}=U(),{user:s}=_(),[u,S]=m.useState(""),[p,g]=m.useState("all"),[o,j]=m.useState({open:!1,course:null}),[i,f]=m.useState({studentId:(s==null?void 0:s.id)||"",name:(s==null?void 0:s.name)||"",email:(s==null?void 0:s.email)||"",phone:"",courseId:""}),[x,y]=m.useState({open:!1,message:"",severity:"success"}),D=Array.from(new Set(r.map(t=>t.department).filter(Boolean))),I=r.filter(t=>{const a=t.title.toLowerCase().includes(u.toLowerCase())||t.code.toLowerCase().includes(u.toLowerCase()),P=p==="all"||t.department===p,F=t.status==="active";return a&&P&&F}),w=async()=>{o.course&&(await l({...i,courseId:o.course.id}),j({open:!1,course:null}),f({...i,phone:"",courseId:""}))},L=t=>c((s==null?void 0:s.id)||"",t);return e.jsxs(h,{sx:{p:3},children:[e.jsx(d,{variant:"h4",gutterBottom:!0,children:"Available Courses"}),e.jsxs(n,{container:!0,spacing:2,sx:{mb:4},children:[e.jsx(n,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,label:"Search Courses",value:u,onChange:t=>S(t.target.value),InputProps:{startAdornment:e.jsx(J,{position:"start",children:e.jsx(K,{})})}})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs($,{fullWidth:!0,children:[e.jsx(q,{children:"Department"}),e.jsxs(H,{value:p,onChange:t=>g(t.target.value),label:"Department",children:[e.jsx(A,{value:"all",children:"All Departments"}),D.map(t=>e.jsx(A,{value:t,children:t},t))]})]})})]}),e.jsx(n,{container:!0,spacing:3,children:I.map(t=>{const a=L(t.id);return e.jsx(n,{item:!0,xs:12,md:6,lg:4,children:e.jsxs(Q,{children:[e.jsxs(V,{children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:t.title}),e.jsx(d,{variant:"subtitle2",color:"textSecondary",gutterBottom:!0,children:t.code}),e.jsx(h,{sx:{mt:2,mb:2},children:e.jsx(d,{variant:"body2",paragraph:!0,children:t.description})}),e.jsxs(n,{container:!0,spacing:1,children:[e.jsx(n,{item:!0,xs:12,children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(G,{fontSize:"small"}),e.jsxs(d,{variant:"body2",children:["Instructor: ",t.instructor]})]})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(O,{fontSize:"small"}),e.jsxs(d,{variant:"body2",children:["Schedule: ",t.schedule]})]})})]}),e.jsxs(h,{sx:{mt:2},children:[e.jsx(E,{label:`${t.currentEnrollment}/${t.enrollmentLimit} enrolled`,color:t.currentEnrollment>=t.enrollmentLimit?"error":"primary",size:"small",sx:{mr:1}}),a&&e.jsx(E,{label:a,color:a==="enrolled"?"success":a==="pending"?"warning":"default",size:"small"})]})]}),e.jsx(oe,{children:e.jsx(b,{size:"small",color:"primary",onClick:()=>j({open:!0,course:t}),disabled:t.currentEnrollment>=t.enrollmentLimit||a==="enrolled"||a==="pending",children:a==="enrolled"?"Already Enrolled":a==="pending"?"Enrollment Pending":"Enroll Now"})})]})},t.id)})}),e.jsxs(X,{open:o.open,onClose:()=>j({open:!1,course:null}),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(Z,{children:["Pre-Enrollment Form",o.course&&e.jsxs(d,{variant:"subtitle2",color:"textSecondary",children:[o.course.title," (",o.course.code,")"]})]}),e.jsx(Y,{children:e.jsxs(n,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(C,{fullWidth:!0,label:"Full Name",value:i.name,onChange:t=>f({...i,name:t.target.value}),disabled:!!s})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(C,{fullWidth:!0,label:"Email",type:"email",value:i.email,onChange:t=>f({...i,email:t.target.value}),disabled:!!s})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(C,{fullWidth:!0,label:"Phone Number",value:i.phone,onChange:t=>f({...i,phone:t.target.value}),required:!0})})]})}),e.jsxs(ee,{children:[e.jsx(b,{onClick:()=>j({open:!1,course:null}),children:"Cancel"}),e.jsx(b,{onClick:w,variant:"contained",color:"primary",children:"Submit Pre-Enrollment"})]})]}),e.jsx(te,{open:x.open,autoHideDuration:6e3,onClose:()=>y({...x,open:!1}),anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(se,{onClose:()=>y({...x,open:!1}),severity:x.severity,children:x.message})})]})};export{ye as default};
