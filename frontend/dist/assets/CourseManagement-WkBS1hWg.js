import{t as oe,j as e,w as de,C as ue,r as a,B as F,T as c,b as m,P as B,M as p,y as P,z as q,A as M}from"./index-DbYJZ2L_.js";import{G as s}from"./Grid-CxKDHTfu.js";import{T as i,F as O,I as V,S as $}from"./TextField-euSIM9bC.js";import{I as ce}from"./InputAdornment-X35RwOd0.js";import{S as me}from"./Search-LyFBzRMS.js";import{M as x}from"./MenuItem-0KJet2kV.js";import{a as he,b as xe,c as je,d as z,T as l,e as pe}from"./TableRow-CFf1-TFU.js";import{C as Ce}from"./Chip-CfcJRCOp.js";import{T as C}from"./Tooltip-YsvtwHIz.js";import{V as fe}from"./Visibility-CKjarfAu.js";import{E as ge}from"./Edit-BUbRZF3e.js";import{B as ve}from"./Block-Bmhsg085.js";import{A as De}from"./CheckCircle-eaO69CVF.js";import{D as Ie}from"./Delete-EPqeyTsI.js";import{D as E,a as T}from"./DialogContent-B5Ew9i7T.js";import{D as W}from"./DialogTitle-BRTcPFtJ.js";import{D as y}from"./DialogActions-DhEqDZ3P.js";import"./useId-DB69X5YC.js";import"./dividerClasses-DklEsgBA.js";import"./Popper-DvBmSgVG.js";const Se=oe(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),G={code:"",title:"",description:"",department:"",instructor:"",duration:8,schedule:"",enrollmentLimit:30,units:3,fee:5e3,startDate:new Date(Date.now()+7*24*60*60*1e3).toISOString()},Ne=()=>{var k;const{courses:f,addCourse:H,updateCourse:N,deleteCourse:R,toggleCourseStatus:U}=de(),{requests:A}=ue(),[g,J]=a.useState(""),[v,K]=a.useState("all"),[D,Q]=a.useState("all"),[r,n]=a.useState(G),[h,w]=a.useState(null),[X,I]=a.useState(!1),[Y,j]=a.useState(!1),[o,L]=a.useState(null),[d,S]=a.useState({open:!1,courseId:null}),Z=Array.from(new Set(f.map(t=>t.department).filter(Boolean))),_=f.filter(t=>{const u=t.title.toLowerCase().includes(g.toLowerCase())||t.code.toLowerCase().includes(g.toLowerCase()),ie=v==="all"||t.department===v,ae=D==="all"||t.status===D;return u&&ie&&ae}),ee=()=>{if(h){const t={code:r.code,title:r.title,description:r.description,department:r.department,instructor:r.instructor,duration:r.duration,schedule:r.schedule,enrollmentLimit:r.enrollmentLimit,units:r.units,fee:r.fee,startDate:r.startDate};N(h.id,{...t,status:h.status})}else H({...r,status:"active"});b()},b=()=>{I(!1),w(null),n(G)},te=t=>{w(t),n({code:t.code,title:t.title,description:t.description,department:t.department||"",instructor:t.instructor||"",duration:t.duration,schedule:t.schedule||"",enrollmentLimit:t.enrollmentLimit,units:t.units||3,fee:t.fee,startDate:t.startDate}),I(!0)},re=t=>A.filter(u=>u.courseId===t&&u.status==="approved"),se=t=>A.filter(u=>u.courseId===t&&u.status==="pending"),le=t=>{L(t),j(!0)},ne=()=>{o&&(R(o.id),j(!1),L(null))};return e.jsxs(F,{sx:{p:3},children:[e.jsxs(F,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[e.jsx(c,{variant:"h4",children:"Course Management"}),e.jsx(m,{variant:"contained",startIcon:e.jsx(Se,{}),onClick:()=>I(!0),children:"Add New Course"})]}),e.jsx(B,{sx:{p:2,mb:3},children:e.jsxs(s,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(i,{fullWidth:!0,label:"Search Courses",value:g,onChange:t=>J(t.target.value),InputProps:{startAdornment:e.jsx(ce,{position:"start",children:e.jsx(me,{})})}})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsxs(O,{fullWidth:!0,children:[e.jsx(V,{children:"Department"}),e.jsxs($,{value:v,onChange:t=>K(t.target.value),label:"Department",children:[e.jsx(x,{value:"all",children:"All Departments"}),Z.map(t=>e.jsx(x,{value:t,children:t},t))]})]})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsxs(O,{fullWidth:!0,children:[e.jsx(V,{children:"Status"}),e.jsxs($,{value:D,onChange:t=>Q(t.target.value),label:"Status",children:[e.jsx(x,{value:"all",children:"All Status"}),e.jsx(x,{value:"active",children:"Active"}),e.jsx(x,{value:"inactive",children:"Inactive"})]})]})})]})}),e.jsx(he,{component:B,children:e.jsxs(xe,{children:[e.jsx(je,{children:e.jsxs(z,{children:[e.jsx(l,{children:"Code"}),e.jsx(l,{children:"Title"}),e.jsx(l,{children:"Department"}),e.jsx(l,{children:"Instructor"}),e.jsx(l,{children:"Enrollment"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(pe,{children:_.map(t=>e.jsxs(z,{children:[e.jsx(l,{children:t.code}),e.jsx(l,{children:t.title}),e.jsx(l,{children:t.department}),e.jsx(l,{children:t.instructor}),e.jsxs(l,{children:[t.currentEnrollment,"/",t.enrollmentLimit]}),e.jsx(l,{children:e.jsx(Ce,{label:t.status,color:t.status==="active"?"success":"default"})}),e.jsxs(l,{children:[e.jsx(C,{title:"View Enrolled Students",children:e.jsx(p,{onClick:()=>S({open:!0,courseId:t.id}),children:e.jsx(fe,{})})}),e.jsx(C,{title:"Edit Course",children:e.jsx(p,{onClick:()=>te(t),children:e.jsx(ge,{})})}),e.jsx(C,{title:t.status==="active"?"Deactivate":"Activate",children:e.jsx(p,{onClick:()=>U(t.id),children:t.status==="active"?e.jsx(ve,{}):e.jsx(De,{})})}),e.jsx(C,{title:"Delete Course",children:e.jsx(p,{onClick:()=>le(t),color:"error",children:e.jsx(Ie,{})})})]})]},t.id))})]})}),e.jsxs(E,{open:X,onClose:b,maxWidth:"md",fullWidth:!0,children:[e.jsx(W,{children:h?"Edit Course":"Add New Course"}),e.jsx(T,{children:e.jsxs(s,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Course Code",value:r.code,onChange:t=>n({...r,code:t.target.value}),required:!0})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Course Title",value:r.title,onChange:t=>n({...r,title:t.target.value}),required:!0})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Description",value:r.description,onChange:t=>n({...r,description:t.target.value}),multiline:!0,rows:3,required:!0})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Department",value:r.department,onChange:t=>n({...r,department:t.target.value})})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Instructor",value:r.instructor,onChange:t=>n({...r,instructor:t.target.value})})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,type:"number",label:"Duration (weeks)",value:r.duration,onChange:t=>n({...r,duration:parseInt(t.target.value)}),required:!0})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Schedule",value:r.schedule,onChange:t=>n({...r,schedule:t.target.value})})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,type:"number",label:"Enrollment Limit",value:r.enrollmentLimit,onChange:t=>n({...r,enrollmentLimit:parseInt(t.target.value)}),required:!0})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,type:"number",label:"Units",value:r.units,onChange:t=>n({...r,units:parseInt(t.target.value)})})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,type:"number",label:"Course Fee",value:r.fee,onChange:t=>n({...r,fee:parseFloat(t.target.value)}),required:!0})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,type:"date",label:"Start Date",value:r.startDate.split("T")[0],onChange:t=>n({...r,startDate:new Date(t.target.value).toISOString()}),InputLabelProps:{shrink:!0},required:!0})})]})}),e.jsxs(y,{children:[e.jsx(m,{onClick:b,children:"Cancel"}),e.jsx(m,{onClick:ee,variant:"contained",children:h?"Update Course":"Add Course"})]})]}),e.jsxs(E,{open:d.open,onClose:()=>S({open:!1,courseId:null}),maxWidth:"md",fullWidth:!0,children:[e.jsxs(W,{children:["Enrolled Students",d.courseId&&e.jsx(c,{variant:"subtitle2",color:"textSecondary",children:(k=f.find(t=>t.id===d.courseId))==null?void 0:k.title})]}),e.jsxs(T,{children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Approved Enrollments"}),e.jsx(P,{children:d.courseId&&re(d.courseId).map(t=>e.jsx(q,{children:e.jsx(M,{primary:t.name,secondary:`Email: ${t.email} | Phone: ${t.phone}`})},t.id))}),e.jsx(c,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:"Pending Enrollments"}),e.jsx(P,{children:d.courseId&&se(d.courseId).map(t=>e.jsx(q,{children:e.jsx(M,{primary:t.name,secondary:`Email: ${t.email} | Phone: ${t.phone}`})},t.id))})]}),e.jsx(y,{children:e.jsx(m,{onClick:()=>S({open:!1,courseId:null}),children:"Close"})})]}),e.jsxs(E,{open:Y,onClose:()=>j(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(W,{children:"Confirm Delete Course"}),e.jsxs(T,{children:[e.jsxs(c,{children:['Are you sure you want to delete the course "',o==null?void 0:o.title,'"? This action cannot be undone.']}),o&&o.currentEnrollment>0&&e.jsxs(c,{color:"error",sx:{mt:2},children:["Warning: This course has ",o.currentEnrollment," enrolled students. Deleting it will remove all enrollment records."]})]}),e.jsxs(y,{children:[e.jsx(m,{onClick:()=>j(!1),children:"Cancel"}),e.jsx(m,{onClick:ne,color:"error",variant:"contained",children:"Delete Course"})]})]})]})};export{Ne as default};
